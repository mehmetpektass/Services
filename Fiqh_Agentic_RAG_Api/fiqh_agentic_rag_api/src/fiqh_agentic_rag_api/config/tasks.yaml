search_task:
  description: >
    Current Question: "{question}"
    
    1. Analyze the current question in the context of the conversation history.
    2. Identify the core intent (resolve pronouns like "it", "he", "that" using history).
    3. Search the database for the top 3 most relevant short texts.
  expected_output: >
    A list of relevant raw texts with their sources.
  agent: db_researcher

writing_task:
  description: >
    Using the research findings, formulate a response to "{question}".
    
    GUIDELINES:
    - Keep it under 150 words.
    - Be direct and concise.
    - If the user is greeting, greet back shortly.
    - If the user asks a question, answer it immediately.
    - Do not use complex headers or academic formatting.
  expected_output: >
    A short, conversational, and accurate text response.
  agent: fiqh_writer

review_task:
  description: >
    Review the draft response for brevity and clarity.
    If it's too long, summarize it.
    Ensure it flows naturally as a chat message.
  expected_output: >
    Final polished response ready for the user.
  agent: content_reviewer